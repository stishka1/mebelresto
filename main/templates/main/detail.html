{% extends "main/base.html" %}
{% load static %}

{% block content %}

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Сайт реставрационной студии</title>
  <link rel="stylesheet" type="text/css" href="{% static 'main/css/detail.css' %}">

  <!-- Fotorama from CDNJS, 19 KB -->
  <link  href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script>

  <script src="https://yastatic.net/share2/share.js"></script>

</head>
<body>
    <div class="main-container">
      <div class="container pb50">
        <div class="row">
            <div class="col-md-12 mb40">
                <article>
                    <!-- <img src="https://bootdey.com/img/Content/bg1.jpg" alt="" class="img-fluid mb30"> -->
                    <div class="post-content">
                      <section class="headline">
                        <h1 class="post-title">{{ post.title }}</h1>
                      </section>
                      <div class="">
                        <div class="fotorama detail-image" data-loop="true" data-nav="false" data-keyboard="true" data-video="true" data-width="100%" data-ratio="800/600">
                          {% if post.post_img1 %}
                            <img src="{{ post.post_img1.url }}">
                          {% endif %}
                          {% if post.post_img2 %}
                            <img src="{{ post.post_img2.url }}">
                          {% endif %}
                          {% if post.post_img3 %}
                            <img src="{{ post.post_img3.url }}">
                          {% endif %}
                          {% if post.post_img4 %}
                            <img src="{{ post.post_img4.url }}">
                          {% endif %}
                          {% if post.post_img5 %}
                            <img src="{{ post.post_img5.url }}">
                          {% endif %}
                          {% if post.post_img6 %}
                            <img src="{{ post.post_img6.url }}">
                          {% endif %}
                          {% if post.post_img7 %}
                            <img src="{{ post.post_img7.url }}">
                          {% endif %}
                          {% if post.post_img8 %}
                            <img src="{{ post.post_img8.url }}">
                          {% endif %}
                          {% if post.post_img9 %}
                            <img src="{{ post.post_img9.url }}">
                          {% endif %}
                          {% if post.post_img10 %}
                            <img src="{{ post.post_img10.url }}">
                          {% endif %}
                          {% if post.video %}
                            <a href="#">
                            </a>
                          {% endif %}
                        </div>
                      </div>
                        <!-- <ul class="post-meta list-inline">
                            <li class="list-inline-item">
                                <i class="fa fa-user-circle-o"></i> <a href="#">John Doe</a>
                            </li>
                            <li class="list-inline-item">
                                <i class="fa fa-calendar-o"></i> <a href="#">29 June 2017</a>
                            </li>
                            <li class="list-inline-item">
                                <i class="fa fa-tags"></i> <a href="#">Bootstrap4</a>
                            </li>
                        </ul> -->
                        <div class="">
                          <p style="line-height: 36px; margin-bottom: 36px; font-weight: 400;">{{ post.description|safe }} 3 </p>
                        </div>
                        <div class="ya-share2" data-curtain data-shape="round" data-color-scheme="whiteblack" data-limit="0" data-more-button-type="short" data-services="vkontakte,odnoklassniki,telegram,whatsapp"></div>
                        <hr class="mb40">
                        <h4 class="mb40 text-uppercase font500">О нас</h4>
                        <div class="media mb40">
                            <!-- <i class="d-flex mr-3 fa fa-user-circle fa-5x text-primary"></i> -->
                            <img src="{% static 'main/images/logo_small.png' %}" alt="Logo" width="100" height="100" class="d-inline-block align-text-center">
                            <div class="media-body">
                                <h5 class="mt-0 font700">mebel.rest</h5>MebelRest - ремонт мебели и услуги по обивке. Мы реставрируем мебель.
                            </div>
                        </div>
                    </div>
                </article>
                <!-- post article-->
    
            </div>
            <!-- <div class="col-lg-3 m-15px-tb blog-aside"> -->
                <!-- <div class="mb40">
                    <form>
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Search..." aria-describedby="basic-addon2">
                            <button class="input-group-addon" id="basic-addon2"><i class="fa fa-search"></i></button>
                        </div>
                    </form>
                </div> -->
                <!--/col-->
                <!-- <div class="mb40">
                    <h4 class="sidebar-title">Categories</h4>
                    <ul class="list-unstyled categories">
                        <li><a href="#">Rent</a></li>
                        <li><a href="#">Sale</a></li>
                        <li class="active"><a href="#">Apartment</a>
                            <ul class="list-unstyled">
                                <li><a href="#">Office</a></li>
                                <li><a href="#">Godown</a></li>
                                <li><a href="#">Gerage</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Top Rating</a></li>
                        <li><a href="#">Trending</a></li>
                        <li><a href="#">Newest Properties</a></li>
                    </ul>
                </div> -->
                <!--/col-->
                <!-- widget Tags -->
                <!-- <div class="widget widget-tags">
                  <div class="widget-title">
                    <h3>Облако тегов</h3>
                  </div>
                  <div class="widget-body">
                    <div class="nav tag-cloud">
                      <div class="content"></div>
                      {% for item in posts %}
                      {% for tag in item.tags.all %}
                      <a href="{% url 'detail' tag.slug %}">
                        {{ tag.name }}
                      </a>
                      {% if not forloop.last %}
                      {% endif %}
                      {% endfor %}
                      {% endfor %}
                    </div>
                  </div>
                </div> -->
                <!-- End widget Tags
                <-- Latest Post -->
                <!-- <div class="widget widget-latest-post">
                  <div class="widget-title">
                    <h3>Недавние посты</h3>
                  </div>
                  <div class="widget-body">
                    <div class="latest-post-aside media">
                      <div class="lpa-left media-body">
                        <div class="lpa-title">
                          <h5><a href="#">Восстановление итальянского гарнитура</a></h5>
                        </div>
                        <div class="lpa-meta">
                          <a class="name" href="#">
                            Rachel Roth
                            </a>
                            <a class="date" href="#">
                              26 FEB 2020
                            </a>
                        </div>
                      </div>
                      <div class="lpa-right">
                        <a href="#">
                          <img src="https://www.bootdey.com/image/400x200/E6E6FA/000000" title="" alt="">
                        </a>
                      </div>
                    </div>
                  </div>
                </div> -->
            <!-- </div> -->
        </div>
      </div>
    </div>

    <!-- <script>
      $(document).on('click', ".clear-search", function(event){
        history.replaceState(null, null, '/')
      });
    </script> -->


<!-- Живой поиск с подстановкой на AJAX и Javascript -->
<script>
  const searchForm = document.getElementById('search-form')
  const searchInput = document.getElementById('search-input')
  const resultsBox = document.getElementById('results-box')
  const csrf = document.getElementsByName('csrfmiddlewaretoken')[0].value
  
  const sendSearchData = (post) => {
    $.ajax({
      type: 'POST',
      url: 'live_search/',
      data: {
        'csrfmiddlewaretoken': csrf,
        'post': post,
      },
      success: (res)=> {
        console.log(res.data)
        const data = res.data
        if (Array.isArray(data)) {
          resultsBox.innerHTML = ""
          data.forEach(post=> {
            resultsBox.innerHTML += `
              <a href="${post.slug}" class="item">
                <div class="row mt-2 mb-2">
                  <div class="col-4">
                    <img src="${post.image}" class="post-img">
                  </div>
                  <div class="col-8">
                    <p style="font-size: 12px; margin-top: 10px;">${post.title}</p>
                  </div>
                </div>
              </a>
            `
          })
        } else {
          if (searchInput.value.length > 0) {
            resultsBox.innerHTML = `<b>${data}</b>`
          } else {
            resultsBox.classList.add('not-visible')
          }
        }
      },
      error: (err)=> {
        console.log(err)
      }
    })
  }

  searchInput.addEventListener('keyup', e=> {
      history.replaceState(null, null, '/')
      console.log(e.target.value)

      if (resultsBox.classList.contains('not-visible')) {
        resultsBox.classList.remove('not-visible')
      }

      sendSearchData(e.target.value)
  })
</script>

</body>
</html>

{% endblock %}